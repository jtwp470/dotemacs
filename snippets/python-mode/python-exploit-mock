# -*- mode: snippet; require-final-newline: nil -*-
# name: python-exploit-mock
# key: exp-mock
# binding: direct-keybinding
# --
#!/usr/bin/env python2
# -*- coding: utf-8 -*-
import socket
import struct
import telnetlib


def sock(remoteip, remoteport):
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((remoteip, remoteport))
    return s, s.makefile('rw', bufsize=0)


# f.write() で送信
# read_until()で読み込み
def read_until(f, delim='\n'):
    data = ''
    while not data.endswith(delim):
        data += f.read(1)
    return data


def shell(s):
    t = telnetlib.Telnet()
    t.sock = s
    t.interact()

pQ = lambda a: struct.pack("<Q", a)
uQ = lambda a: struct.unpack("<Q", a)[0]


def main():
    HOST, PORT = "$0", $1

    s, f = sock(HOST, PORT)


if __name__ == "__main__":
  main()
